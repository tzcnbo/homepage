import React, { useState, useEffect } from 'react';
import { Terminal, ArrowRight, Copy, Check, Zap, Globe, Shield } from 'lucide-react';

// --- Components ---

const AnimatedLabel = () => {
  const colors = [
    '#67C3F8', // Blue (Original)
    '#F97316', // Orange
    '#10B981', // Emerald
    '#FDE047', // Yellow
    '#F472B6', // Pink
    '#A78BFA', // Purple
  ];
  
  const [currentColor, setCurrentColor] = useState(colors[0]);
  const [nextColor, setNextColor] = useState(colors[1]);
  const [isAnimating, setIsAnimating] = useState(false);

  useEffect(() => {
    const interval = setInterval(() => {
      // Pick a random color distinct from the current one
      let randomColor;
      do {
        randomColor = colors[Math.floor(Math.random() * colors.length)];
      } while (randomColor === currentColor);
      
      setNextColor(randomColor);
      setIsAnimating(true);

      // Wait for the slide animation to finish (1s), then update the base color
      setTimeout(() => {
        setCurrentColor(randomColor);
        setIsAnimating(false);
      }, 1000); // Matches the duration-1000 class
    }, 7000); // 7 seconds interval

    return () => clearInterval(interval);
  }, [currentColor]);

  return (
    <span className="relative inline-block px-2 border-2 border-black transform -rotate-1 shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] my-2 overflow-hidden align-middle select-none">
      {/* Base Layer (Current Color) */}
      <div 
        className="absolute inset-0 z-0" 
        style={{ backgroundColor: currentColor }} 
      />
      
      {/* Wiper Layer (Next Color) - Slides in from left */}
      <div 
        className={`absolute top-0 bottom-0 left-0 z-10 transition-[width] ease-in-out duration-1000 ${isAnimating ? 'w-full' : 'w-0'}`}
        style={{ backgroundColor: nextColor }} 
      />
      
      {/* Text Layer (Must be on top) */}
      <span className="relative z-20">Claude Code</span>
    </span>
  );
};

const Hero = () => {
  return (
    <div className="relative overflow-hidden w-full min-h-screen flex flex-col lg:flex-row items-center justify-center max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 lg:py-0">
      
      {/* Decorative Elements (Clouds & Shapes) */}
      <FloatingElements />

      {/* Left Content */}
      <div className="w-full lg:w-1/2 z-10 flex flex-col justify-center mb-12 lg:mb-0">
        <h1 className="font-mono text-5xl sm:text-6xl lg:text-7xl font-bold leading-[1.1] text-black mb-8 tracking-tighter">
          专业<br />
          <AnimatedLabel /><br />
          中转服务
        </h1>
        
        <p className="font-mono text-lg sm:text-xl text-gray-800 mb-10 max-w-xl leading-relaxed">
          提供专业的ClaudeCode中转服务，每次调用都来自纯血Max号池。
        </p>

        {/* Buttons removed here */}

        {/* Trust Badges */}
        <div className="mt-16 flex items-center gap-8 opacity-60 grayscale hover:grayscale-0 transition-all duration-500">
          <div className="flex items-center gap-2 font-mono text-sm font-bold"><Globe size={16}/> 99.9% 在线率</div>
          <div className="flex items-center gap-2 font-mono text-sm font-bold"><Shield size={16}/> 企业级支持</div>
        </div>
      </div>

      {/* Right Content (Interactive Terminal) */}
      <div className="w-full lg:w-1/2 z-20 flex justify-center lg:justify-end">
        <CodeWindow />
      </div>
    </div>
  );
};

const CodeWindow = () => {
  const [copied, setCopied] = useState(false);

  const codeSnippet = `crying@mma:~/my-project$ export ANTHROPIC_BASE_URL="https://api.newapi.com/anthropic"
crying@mma:~/my-project$ export ANTHROPIC_API_KEY="sk-..."
crying@mma:~/my-project$ export ANTHROPIC_MODEL="claude-opus-4-6"
crying@mma:~/my-project$ claude`;

  const handleCopy = () => {
    navigator.clipboard.writeText(codeSnippet);
    setCopied(true);
    setTimeout(() => setCopied(false), 2000);
  };

  // Helper function to highlight shell commands
  const renderShellLine = (line, i) => {
    const prompt = "crying@mma:~/my-project$";
    
    if (line.startsWith(prompt)) {
        const commandPart = line.substring(prompt.length);
        return (
            <div key={i} className="font-mono whitespace-nowrap">
                <span className="text-green-400 font-bold">crying@mma</span>
                <span className="text-white">:</span>
                <span className="text-blue-400 font-bold">~/my-project</span>
                <span className="text-white">$</span>
                {/* Command Highlighting */}
                {commandPart.split(' ').map((word, j) => {
                     // Add a space before each word
                    const prefix = j === 0 ? ' ' : ' ';
                    if (word === 'export') return <span key={j} className="text-[#ff79c6]">{prefix}{word}</span>;
                    if (word.startsWith('"')) return <span key={j} className="text-[#a5d6ff]">{prefix}{word}</span>;
                    if (word.includes('=')) {
                        const [key, val] = word.split('=');
                        return (
                            <span key={j}>
                                {prefix}
                                <span className="text-white">{key}</span>
                                <span className="text-[#ff79c6]">=</span>
                                <span className="text-[#a5d6ff]">{val}</span>
                            </span>
                        );
                    }
                    if (word === 'claude') return <span key={j} className="text-[#f1fa8c] font-bold">{prefix}{word}</span>;
                    return <span key={j} className="text-white">{prefix}{word}</span>;
                })}
            </div>
        )
    }
    return (
        <div key={i} className="font-mono text-gray-300 whitespace-pre-wrap">
             {line}
        </div>
    );
  }

  return (
    <div className="relative w-full max-w-xl">
      {/* Window Header removed */}

      {/* Window Body */}
      <div className="bg-[#1a1a1a] border-2 border-black p-6 rounded-sm shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] relative min-h-[360px] flex flex-col">
        {/* Traffic Lights */}
        <div className="absolute top-4 right-4 flex gap-2">
          <div className="w-3 h-3 rounded-full bg-red-500 border border-black/50"></div>
          <div className="w-3 h-3 rounded-full bg-yellow-500 border border-black/50"></div>
          <div className="w-3 h-3 rounded-full bg-green-500 border border-black/50"></div>
        </div>

        <div className="mb-6 font-mono text-xs text-gray-500 mt-2 select-none">
          # Initializing environment variables...
        </div>
        
        {/* Code Content Container with hidden scrollbar */}
        <div className="overflow-x-auto pb-4 scrollbar-hide" style={{ scrollbarWidth: 'none', msOverflowStyle: 'none' }}>
           <div className="font-mono text-sm leading-loose min-w-max">
            {codeSnippet.split('\n').map((line, i) => renderShellLine(line, i))}
           </div>
        </div>

        {/* Copy Button */}
        <button 
          onClick={handleCopy}
          className="absolute bottom-4 right-4 p-2 bg-[#2a2a2a] border border-gray-600 rounded hover:bg-[#333] transition-colors group z-20"
        >
          {copied ? <Check size={16} className="text-green-400" /> : <Copy size={16} className="text-gray-400 group-hover:text-white" />}
        </button>
        
        {/* Terminal Result Simulation */}
        <div className="mt-auto pt-4 border-t border-gray-800">
          <div className="font-mono text-sm text-gray-300">
             <span className="text-gray-500 mb-2 block">Welcome to Claude Code (v4-6)</span>
             "你好！我是 Claude，一个由 Anthropic 开发的 AI 助手。今天有什么我可以帮你的吗？"
             <span className="animate-pulse inline-block w-2 h-4 bg-gray-500 ml-1 align-middle"></span>
          </div>
        </div>
      </div>
    </div>
  );
};

const FloatingElements = () => (
  <div className="absolute inset-0 pointer-events-none overflow-hidden select-none">
    {/* Cloud Top Left */}
    <svg className="absolute top-20 left-10 lg:left-20 w-24 h-24 text-black opacity-80 transform -rotate-12" viewBox="0 0 100 100" fill="white" stroke="currentColor" strokeWidth="2.5">
      <path d="M25,60 Q10,60 10,45 Q10,30 25,30 Q30,10 50,10 Q70,10 75,30 Q90,30 90,45 Q90,60 75,60 Z" />
    </svg>

    {/* Cloud Bottom Center/Right */}
    <svg className="absolute bottom-10 right-10 lg:right-1/3 w-32 h-32 text-black opacity-80 z-0" viewBox="0 0 100 100" fill="white" stroke="currentColor" strokeWidth="2.5">
      <path d="M25,65 Q5,65 5,45 Q5,25 25,25 Q35,5 55,5 Q75,5 80,25 Q95,25 95,45 Q95,65 80,65 Z" />
    </svg>

    {/* Geometric Shape (Cylinder) */}
    <div className="absolute top-1/4 right-10 lg:right-20 animate-float hidden lg:block">
      <svg width="60" height="80" viewBox="0 0 60 80" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M60 15C60 23.2843 46.5685 30 30 30C13.4315 30 0 23.2843 0 15C0 6.71573 13.4315 0 30 0C46.5685 0 60 6.71573 60 15Z" fill="#10B981" stroke="black" strokeWidth="2"/>
        <path d="M0 15V65C0 73.2843 13.4315 80 30 80C46.5685 80 60 73.2843 60 65V15" fill="#10B981" stroke="black" strokeWidth="2"/>
        <path d="M0 15C0 23.2843 13.4315 30 30 30C46.5685 30 60 23.2843 60 15" stroke="black" strokeWidth="2"/>
      </svg>
    </div>

    {/* Diamond Shape */}
    <div className="absolute top-1/3 left-1/2 transform -translate-x-1/2 -translate-y-1/2 lg:hidden">
       <div className="w-8 h-8 border-2 border-black rotate-45 bg-transparent"></div>
    </div>
    
     {/* Diamond Shape Top Right */}
    <div className="absolute top-32 right-[20%] w-6 h-6 border-2 border-black rotate-45 bg-transparent hidden md:block"></div>
  </div>
);

const App = () => {
  useEffect(() => {
    const style = document.createElement('style');
    style.innerHTML = `
      @import url('https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&display=swap');
      
      body {
        background-color: #FAF7F2;
      }
      
      .font-mono {
        font-family: 'Space Mono', monospace;
        /* Fallback for Chinese characters to system fonts */
        font-family: 'Space Mono', 'PingFang SC', 'Microsoft YaHei', monospace;
      }
      
      /* Utility for hiding scrollbar */
      .scrollbar-hide::-webkit-scrollbar {
          display: none;
      }
      .scrollbar-hide {
          -ms-overflow-style: none;
          scrollbar-width: none;
      }
      
      @keyframes float {
        0% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
        100% { transform: translateY(0px); }
      }
      
      .animate-float {
        animation: float 6s ease-in-out infinite;
      }
    `;
    document.head.appendChild(style);
    return () => document.head.removeChild(style);
  }, []);

  return (
    <div className="min-h-screen flex flex-col font-sans text-black">
      {/* Navbar removed */}
      <main className="flex-grow flex flex-col justify-center">
        <Hero />
        {/* Features removed */}
      </main>
      {/* Footer removed */}
    </div>
  );
};

export default App;
